# Localtest.md - ローカルテスト指示書

ローカル環境でクラウド移行前に確認すべき作業を、役割ごとの視点を統合してまとめる。

---

## 1. 初期セットアップ（共通）
1. **環境変数**
   - `cp env.example .env` で `.env` を作成し必要値を設定。
   - `OPENAI_API_KEY` など機密値は環境変数で注入。
2. **依存関係のインストール**
   - `python -m venv .venv && source .venv/bin/activate`
   - `pip install -r requirements.txt`
3. **単体テスト実行**
   - `pytest -q`
4. **アプリ起動**
   - `./start_local.sh` もしくは `./start_docker.sh`

---

## 2. 視点別チェックリスト
### Pythonエンジニア
- 追加テスト (`pytest tests/test_*.py -q`) を実施し、ログで例外が無いか確認。
- `data/` に生成される JSON 構造がスキーマ通りかを検証。

### クラウドエンジニア
- `docker build -t sales-saas-local .` でイメージビルドを確認。
- 必要に応じて `GOOGLE_APPLICATION_CREDENTIALS` など GCP 連携の疎通をテスト。
- `.env` の `STORAGE_PROVIDER` や `APP_ENV` を切り替えた際の挙動を確認。

### UI/UX デザイナー
- サイドバーから主要ページ（事前アドバイス、商談後ふりかえり、アイスブレイク、履歴）へ直感的に移動できるか。
- フォームラベルやボタン配置が一貫し、アクセシビリティ（フォントサイズ・コントラスト）に問題が無いか。
- モバイル表示をブラウザの開発者ツールで確認し、レスポンシブに崩れが無いか。

### ユーザー視点
#### BtoC 営業担当
1. アプリ起動後、「アイスブレイク」ページでタイプ・業界を入力しネタ生成。
2. 「事前アドバイス」ページで情報を入力し、短期/中期アドバイスを確認。
3. 「履歴」で結果が保存されタグ付けできるかを試す。

#### BtoB 営業マネージャー
1. 複数案件を入力し、「商談後ふりかえり」で要約や次アクションを生成。
2. 生成結果を CSV/JSON でエクスポートし、社内共有フローを検証。
3. CRM連携ボタンや設定ページから環境変数の適用を確認。

---

## 3. UX向上のためのデザイン指針
- 主要操作は3クリック以内で完結させる。
- エラー時はフォーム直下に赤字メッセージと修正案を提示。
- ホバー時にツールチップを表示し、初心者でも迷わない導線を確保。

---

## 4. 高負荷価値サービスに向けたフェーズ
1. **フェーズA: ローカル安定化** – テスト整備とUX改善、ログ収集基盤準備。
2. **フェーズB: 負荷試験と最適化** – Docker Composeで並列起動、キャッシュ/非同期処理を検討。
3. **フェーズC: クラウド統合準備** – Secret Manager・GCS 等の接続検証、CI/CD 雛形作成。
4. **フェーズD: マルチテナント & セキュリティ** – テナント分離、監査ログ、PII マスキング、認証と権限の実装。

---

## 5. 作業ログ更新
- 作業後は `WORKLOG.md` に結果と4視点レビューを追記。
- 重要な決定やフェーズ完了時は `AGENT.md` を更新。

